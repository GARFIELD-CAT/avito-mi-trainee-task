# Выполненное Тестовое задание для стажировки в юнит Market Intelligence
## О проекте
API сервис для проведения голосований.  
Есть возможность создать голосование с вариантами ответов, проголосовать за конкретный вариант и 
получить общие результаты голосования.  
Также реализована работа с учетными записями пользователей.  
Работа с методами сервиса голосования реализована через аутентификацию по токену.
## Технологии в проекте
Сервис реализован на языке Python 3.8 с помощью фреймворка Django 3.2 и django rest framework 3.12. В качестве базы данных используется Postgres.
Документация к методам api генерируется автоматически при помощи библиотеки drf_yasg и основана на swagger.io.  
Реализован функционал работы с учетными записями пользователей через api с помощью библиотеки djoser.  
Работа с методами сервиса голосования реализована через аутентификацию по токену.
## Запуск
Как запустить через докер  
как запустить локально у себя.

## Работа с API
Для простоты проверки советую делать все запросы через swagger http://127.0.0.1:8000/swagger/  

После разворачивания сервиса, чтобы начать работу с ним, необходимо:  
1. Создать учетную запись по адресу http://127.0.0.1:8000/auth/users/  
2. Получить токен авторизации по адресу http://127.0.0.1:8000/api/api-token-auth/
3. Указать токен в Headers Authorization запроса: Token <сгенерированное значение>  
В swagger это можно сделать нажав сюда http://joxi.ru/4AkJXkxUkOJWg2 и вставив туда значение - Token <сгенерированное значение>. Пример - http://joxi.ru/zANN7OlTjY7EBA  
Нажать кнопку Authorize.
Это необходимо проделывать каждому пользователю.
4. После этого можно создать новое голосование по адресу http://127.0.0.1:8000/api/v1/createPoll/
5. Проголосовать можно по адресу http://127.0.0.1:8000/api/v1/poll/
6. Получить результаты голосования можно по адресу http://127.0.0.1:8000/api/v1/getResult/
## Структура



## Документация
Документация к api генерируется автоматически и доступна по адресам: http://127.0.0.1:8000/swagger/ и http://127.0.0.1:8000/redoc/
В swagger доступна возможность отправки http запросов к сервису.
## Декомпозиция задачи создания сервиса API.
1. Подготовительные работы
    * Создание проекта на github
    * Клонирование проекта себе на пк
    * Создание отдельной ветки для разработки
    * Настройка виртуального окружения проекта
    * Создание проекта service_api
    * Создание приложения api
    * Выполнение миграций для создания базовых моделей Django
    * Создание суперпользователя
2. Создание моделей
    * Продумывание архитектуры сущностей базы данных в виде схемы
    * В Django модель User уже реализована ее и используем
    * Создание модели Poll - голосование
    * Создание модели Сhoice - вариант голосования
    * Создание модели Vote - голос пользователя
    * Регистрация моделей в админке Django
    * Выполнение миграций для создания объектов в базе данных
3. 
4.
5.

## Усложнения
1. Написаны тесты.  
coverage = 97% http://joxi.ru/DmBaKMkF4eKXlr
3. Опишите, как изменится архитектура, если мы ожидаем большую нагрузку - не реализовано
4. Опишите, как можно защититься от накруток.  
Для борьбы с накрутками я реализовал регистрацию пользователей. Только зарегистрированные пользователи получившие токен авторизации могут проголосовать. Также каждая учетная запись может проголосовать в каждом голосовании только один раз. Если пойти дальше, можно потребовать обязательную регистрацию с email.
5. Попробуйте оценить, какую нагрузку в RPS сможет выдержать ваш сервис - не реализовано
